var BaseServer="";var ErrorShow=null;var G=null;var VaildConstraints=new Array();document.write("<script language='JavaScript' src='js/CuminData.js'><\/script>");document.write("<script language='JavaScript' src='js/validate.js'><\/script>");window.addEventListener("load",function(){G=O();BaseServer="http://"+window.location.host;CuminAjax().AddFilter(IsBackHome)});function IsBackHome(a,b){if(typeof(b)!="string"){if(b.hasOwnProperty("result")){if(b.result==-1){alert(b.msg);JumpTo("http://"+window.location.host);return false}}}return true}function CloseBootstrapModal(a){$(a).map(function(){$(this).modal("hide")})}var reg_http=new RegExp("^.*(.asp|.aspx|.do|.ashx|.webp)$");var reg_webapi=new RegExp("(/.+)+");var reg_base=new RegExp("(http://|https://|file:///).*");var reg_ws=new RegExp("(ws://|wss://).*");var WebSocketCache=new Array();var CuminDataBindClass={CreateInstance:function(c){var b={};b.BindTo=c;b.TemplateName=null;b.SortNumberEvent=null;b.Convertor=null;b.MapEvents=null;b.Url=null;b.AjaxData=null;b.IsGet=false;b.WebSocket=null;if(reg_ws.test(c)){b.Url=c;var a=CuminWebSocket(c);b.WebSocket=a;WebSocketCache[WebSocketCache.length]=a}else{if(reg_http.test(c)||reg_webapi.test(c)){if(reg_base.test(c)){b.Url=c}else{b.Url=BaseServer+c}}}b.Refresh=function(d){Global(this.BindTo).Refresh(d);return this};b.Recover=function(){Global().Recover();return this};b.PageCount=0;b.Items=function(d){this.PageCount=d;return this};b.Page=function(e,d){CuminPage(this.BindTo).Items(this.PageCount).Page(e,d);return this};b.Get=function(d){this.IsGet=true;this.AjaxData=GetNodeData(d);return this};b.Post=function(d){this.IsGet=false;this.AjaxData=GetNodeData(d);return this};b.StringDo=function(f,d){if(CuminAjaxTimeOut){return}if(this.IsGet){try{CuminAjax().ToJson(false).SetSucceed(f).SetFailed(d).UseGet(this.Url).Submit(this.AjaxData)}catch(g){console.error(g);g.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(g)}}}else{try{CuminAjax().ToJson(false).SetSucceed(f).SetFailed(d).UsePost(this.Url).Submit(this.AjaxData)}catch(g){console.error(g);g.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(g)}}}};b.JsonDo=function(f,d){if(CuminAjaxTimeOut){return}if(this.IsGet){try{CuminAjax().ToJson(true).SetSucceed(f).SetFailed(d).UseGet(this.Url).Submit(this.AjaxData)}catch(g){console.error(g);g.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(g)}}}else{try{CuminAjax().ToJson(true).SetSucceed(f).SetFailed(d).UsePost(this.Url).Submit(this.AjaxData)}catch(g){console.error(g);g.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(g)}}}};b.StringTo=function(f){if(CuminAjaxTimeOut){return}if(this.IsGet){try{CuminAjax().ToJson(false).SetSucceed(function(e,g){O(f).Bind(g)}).UseGet(this.Url).Submit(this.AjaxData)}catch(d){console.error(d);d.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(d)}}}else{try{CuminAjax().ToJson(false).SetSucceed(function(e,g){O(f).Bind(g)}).UsePost(this.Url).Submit(this.AjaxData)}catch(d){console.error(d);d.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(d)}}}return this};b.JsonTo=function(g,d){if(CuminAjaxTimeOut){return}if(this.IsGet){try{CuminAjax().ToJson(true).SetSucceed(function(e,h){if(h.hasOwnProperty("code")){if(h.code==1){O(g).Bind(h,d)}}}).UseGet(this.Url).Submit(this.AjaxData)}catch(f){console.error(f);f.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(f)}}}else{try{CuminAjax().ToJson(true).SetSucceed(function(e,h){if(h.hasOwnProperty("code")){if(h.code==1){O(g).Bind(h,d)}}}).UsePost(this.Url).Submit(this.AjaxData)}catch(f){console.error(f);f.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(f)}}}return this};b.NotifyTo=function(f){if(CuminAjaxTimeOut){return}if(this.IsGet){try{CuminAjax().ToJson(true).SetSucceed(function(e,g){if(g.hasOwnProperty("code")){if(g.code==1){G.Notify(f,g)}}}).UseGet(this.Url).Submit(this.AjaxData)}catch(d){console.error(d);d.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(d)}}}else{try{CuminAjax().ToJson(true).SetSucceed(function(e,g){if(g.hasOwnProperty("code")){if(g.code==1){G.Notify(f,g)}}}).UsePost(this.Url).Submit(this.AjaxData)}catch(d){console.error(d);d.message="请检查地址和网络！";if(ErrorShow!=null){ErrorShow(d)}}}return this};b.Start=function(){b.WebSocket.Start();return this};b.Send=function(d){b.WebSocket.Send(d);return this};b.Revice=function(d){b.WebSocket.BindMessageEvent(d);return this};b.Exit=function(d){b.WebSocket.BindCloseEvent(d);return this};b.Close=function(){b.WebSocket.Close();return this};b.UseTemplate=function(d){this.TemplateName=d;return this};b.SortEvent=function(d){this.SortNumberEvent=d;return this};b.Clear=function(){if(this.TemplateName==null){this.TemplateName=this.BindTo}CuminData(this.TemplateName).Clear();return this};b.BeforeCallBack=null;b.BeforeBind=function(d){this.BeforeCallBack=d;return this};b.Bind=function(f,e){if(this.TemplateName==null){this.TemplateName=this.BindTo}var d=CuminData(this.TemplateName);if(d.Model==null){d=document.querySelector(this.TemplateName);if(d.tagName=="INPUT"&&d.tagName=="SELECT"){d.value=f}else{d.innerHTML=f}}else{d.AddSortNumberEvent(this.SortNumberEvent).BeforeBind(this.BeforeCallBack).AddConvertObject(this.Convertor).AddEventsObject(this.MapEvents).Bind(f,e,this.BindTo)
}return this};b.Append=function(e,d){if(this.TemplateName==null){this.TemplateName=this.BindTo}CuminData(this.TemplateName).AddSortNumberEvent(this.SortNumberEvent).BeforeBind(this.BeforeCallBack).AddConvertObject(this.Convertor).AddEventsObject(this.MapEvents).Append(e,d,this.BindTo);return this};b.On=function(d,e){if(d==null){document.querySelector(this.BindTo).addEventListener("mouseover",e)}else{CuminData(this.BindTo).On(d,e)}return this};b.Out=function(d,e){if(d==null){document.querySelector(this.BindTo).addEventListener("mouseout",e)}else{CuminData(this.BindTo).Out(d,e)}return this};b.Click=function(d,e){if(d==null){document.querySelector(this.BindTo).addEventListener("click",e)}else{CuminData(this.BindTo).Click(d,e)}return this};b.Trigger=function(h,f){var e=CuminData(this.BindTo);if(e.Model==null){e=document.querySelector(this.BindTo);if(h!=null){var g=document.querySelector(h);g.Tag=e;var d=g.getAttribute("ClearJson");if(d!=null&&d=="true"){d=true}else{d=false}e.addEventListener("click",function(){var j=e.getAttribute(CuminFlag.OperatorValues);if(j!=null){var i=j.split(";");f(GetNodeJson(h,d,i),g)}else{f(GetNodeJson(h,d),g)}})}else{e.addEventListener("click",f)}}else{e.Trigger(h,f)}return this};b.Convertor=function(d){b.Convertor=d;return this};b.MapEvents=function(d){b.MapEvents=d;return this};b.Notify=function(d,e){if(this.TemplateName==null){this.TemplateName=this.BindTo}CuminData(this.TemplateName).Notify(d,e)};b.AssociatedGet=function(g,d){var f=document.querySelector(this.BindTo);var e=f.getAttribute("field");if(f.tagName=="INPUT"||f.tagName=="SELECT"){f.addEventListener("change",function(){AjaxGet(d+"?"+e+"="+f.value,null,function(h,i){O(g).Bind(i.data)})})}else{f.addEventListener("click",function(){AjaxGet(d+"?"+e+"="+f.value,null,function(h,i){O(g).Bind(i.data)})})}};b.AssociatedPost=function(h,d,i){var g=document.querySelector(this.BindTo);var f=g.getAttribute("field");var e=null;if(g.tagName=="INPUT"||g.tagName=="SELECT"){g.addEventListener("change",function(){var j=new Array();j[f]=g.value;AjaxPost(d,j,function(k,l){O(h).Bind(l.data)})})}else{g.addEventListener("click",function(){var j=new Array();j[f]=g.innerHTML;AjaxPost(d,j,function(k,l){O(h).Bind(l.data)})})}};return b}};function O(a){return CuminDataBindClass.CreateInstance(a)}function V(c){for(var a in c){var b={};b[a]=c[a];VaildConstraints[a]=b}}function Start(a){window.addEventListener("load",a)}function GetNodeData(a){if(a==null){return null}if(typeof(a)=="string"){var d=document.querySelector(a);var e=d.getAttribute(CuminFlag.OperatorValues);var c=d.getAttribute("ClearJson");if(c!=null&&c=="true"){c=true}else{c=false}if(e!=null){var b=e.split(";");return GetNodeJson(a,c,b)}else{return GetNodeJson(a,c,null)}}else{return a}}function AuthDomRender(a){O(a+PageName()).Get().JsonDo(function(b,c){if(c.code==1){AuthRender(c.data)}})};